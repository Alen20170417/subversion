* Extract relevant changes from issue-2897 branch. (stylesen is doing it
  already, expect to complete by 13/12/2007)
